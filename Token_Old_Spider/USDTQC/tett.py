import json
import time

import jsonpath
from pymongo import MongoClient
from SunMongo import SunMongodb

data = '''{"des":"","isSuc":true,"datas":{"marketName":"**","symbol":"usdtqc","contractUnit":"**","data":[[1517414400000,6.2,6.8,6.2,6.509,1794550.8725],[1517500800000,6.509,6.5497,6.2003,6.4243,2289558.6419],[1517587200000,6.4243,6.475,6.3921,6.4,2938557.5115],[1517673600000,6.4,6.6,6.4,6.5399,2545751.4833],[1517760000000,6.5399,6.6295,6.4513,6.5884,3439555.7422],[1517846400000,6.5885,6.7792,6.5,6.5379,3980208.3351],[1517932800000,6.538,6.5758,6.4,6.4221,4182390.2111],[1518019200000,6.4218,6.565,6.4016,6.4704,2105699.0085],[1518105600000,6.474,6.548,6.4304,6.4611,2257106.7426],[1518192000000,6.4611,6.6092,6.457,6.6092,4098773.982],[1518278400000,6.6091,6.68,6.5065,6.589,3202906.5602],[1518364800000,6.5887,6.64,6.405,6.4728,3073627.0957],[1518451200000,6.4657,6.58,6.41,6.5411,3036337.3249],[1518537600000,6.5419,6.5858,6.4,6.5487,5689444.6377],[1518624000000,6.5489,6.63,6.455,6.465,5556173.8283],[1518710400000,6.465,6.55,6.4268,6.5029,5091822.7144],[1518796800000,6.5029,6.666,6.501,6.5439,5392062.7641],[1518883200000,6.5437,6.615,6.455,6.6007,10562169.0284],[1518969600000,6.6007,6.7499,6.5216,6.5317,5331488.2932],[1519056000000,6.5317,6.595,6.5,6.5569,6156140.3852],[1519142400000,6.5579,6.74,6.5262,6.6404,6678688.2497],[1519228800000,6.6401,6.7497,6.533,6.533,6777224.7126],[1519315200000,6.537,6.595,6.5112,6.535,4400313.0062],[1519401600000,6.5362,6.595,6.4015,6.4085,7110046.2744],[1519488000000,6.4086,6.433,6.3902,6.402,4215068.6245],[1519574400000,6.4019,6.492,6.3917,6.4745,3538937.1026],[1519660800000,6.4781,6.525,6.4331,6.482,4682924.9663],[1519747200000,6.4822,6.555,6.444,6.5434,3956930.7791],[1519833600000,6.5421,6.58,6.4955,6.5025,2914881.1557],[1519920000000,6.5032,6.5285,6.461,6.519,2231708.5654],[1520006400000,6.5168,6.519,6.4553,6.4558,2421639.4915],[1520092800000,6.4554,6.492,6.44,6.4601,1878871.3871],[1520179200000,6.4601,6.4761,6.4103,6.4349,3592699.122],[1520265600000,6.4347,6.5,6.4102,6.448,18369656.3404],[1520352000000,6.4489,6.4999,6.436,6.4798,14350564.8953],[1520438400000,6.4797,6.63,6.4735,6.5561,27788428.6521],[1520524800000,6.5568,6.68,6.5542,6.623,18392153.8028],[1520611200000,6.6218,6.68,6.57,6.5781,11972270.0624],[1520697600000,6.5834,6.745,6.55,6.62,13356092.5776],[1520784000000,6.6197,6.625,6.5167,6.58,10486447.5411],[1520870400000,6.5814,6.6399,6.533,6.59,14073657.4636],[1520956800000,6.5913,6.6337,6.531,6.57,11462935.7003],[1521043200000,6.5705,6.745,6.5652,6.627,22716957.3248],[1521129600000,6.6269,6.6815,6.536,6.5422,14416532.815],[1521216000000,6.5457,6.605,6.5356,6.585,9465195.994],[1521302400000,6.5858,6.69,6.57,6.6338,14173369.8219],[1521388800000,6.6328,6.6703,6.52,6.5213,21988605.9585],[1521475200000,6.5213,6.5744,6.4711,6.5252,17309751.6655],[1521561600000,6.5223,6.5488,6.476,6.4906,18363746.0023],[1521648000000,6.4905,6.55,6.4455,6.5392,21767515.4142],[1521734400000,6.5387,6.59,6.535,6.5628,18294010.9437],[1521820800000,6.5623,6.58,6.511,6.525,13401178.3573],[1521907200000,6.525,6.5722,6.505,6.5361,16683724.182],[1521993600000,6.5353,6.56,6.5062,6.5315,25389438.7653],[1522080000000,6.5321,6.5678,6.485,6.5109,38294821.8655],[1522166400000,6.5107,6.5399,6.47,6.4795,27600200.2738],[1522252800000,6.4795,6.5302,6.4669,6.5136,25369232.8287],[1522339200000,6.5137,6.615,6.5,6.58,39101145.0004],[1522425600000,6.5801,6.6362,6.535,6.5433,18513872.2164],[1522512000000,6.5439,6.6099,6.5252,6.6045,14868839.5365],[1522598400000,6.6038,6.61,6.5104,6.528,13900328.188],[1522684800000,6.5284,6.5442,6.445,6.4605,20775569.5177],[1522771200000,6.4607,6.523,6.4323,6.5199,16117093.2833],[1522857600000,6.516,6.559,6.4662,6.4866,21013879.2828],[1522944000000,6.4871,6.535,6.455,6.5062,16232029.4113],[1523030400000,6.5062,6.52,6.4555,6.4556,10935202.3148],[1523116800000,6.4559,6.4678,6.4123,6.4178,10911099.2943],[1523203200000,6.4178,6.4759,6.3917,6.473,15716926.2306],[1523289600000,6.4728,6.505,6.4381,6.441,10939748.7999],[1523376000000,6.441,6.4475,6.3917,6.3917,24173691.9077],[1523462400000,6.3929,6.4418,6.3006,6.3417,50321684.9197],[1523548800000,6.3415,6.45,6.311,6.4303,36062204.7885],[1523635200000,6.4307,6.475,6.35,6.4034,36724360.0299],[1523721600000,6.4034,6.4298,6.32,6.3584,30575657.3906],[1523808000000,6.3583,6.4,6.367,6.3986,7771940.275],[1523894400000,6.3986,6.3998,6.352,6.3712,49977443.9101],[1523980800000,6.3711,6.44,6.3559,6.3789,28352869.1272],[1524067200000,6.3788,6.385,6.3,6.3653,25263815.5556],[1524153600000,6.3652,6.4418,6.355,6.4049,34969187.4664],[1524240000000,6.4045,6.505,6.395,6.4669,43998226.7974],[1524326400000,6.4669,7.1421,6.361,6.3999,39999229.682],[1524412800000,6.3992,6.46,6.376,6.4116,25632144.7162],[1524499200000,6.4116,6.44,6.3403,6.4072,35900706.5446],[1524585600000,6.4071,6.4488,6.3,6.4118,60241698.7047],[1524672000000,6.4119,6.54,6.352,6.511,45015646.188],[1524758400000,6.5111,6.5221,6.2761,6.4124,113747562.7349],[1524844800000,6.3988,6.4643,6.377,6.419,48128142.5037],[1524931200000,6.41,6.4597,6.391,6.4108,12019132.5617],[1525017600000,6.4104,6.5321,6.4031,6.4251,12415915.1491],[1525104000000,6.425,6.533,6.39,6.4743,10827111.6755],[1525190400000,6.4731,6.58,6.4446,6.506,10243698.1024],[1525276800000,6.5061,6.57,6.44,6.5449,54261245.0135],[1525363200000,6.5443,6.5616,6.471,6.4867,49629055.8345],[1525449600000,6.4863,6.545,6.48,6.541,55083228.627],[1525536000000,6.5408,6.62,6.4961,6.5511,61726217.6655],[1525622400000,6.5513,6.677,6.543,6.6243,49638620.5058],[1525708800000,6.6243,6.64,6.57,6.6097,42594719.1736],[1525795200000,6.6092,6.6599,6.5905,6.591,39847980.7817],[1525881600000,6.5912,6.6131,6.5205,6.5391,30584063.3927],[1525968000000,6.539,6.7812,6.5379,6.6704,104171019.1354],[1526054400000,6.6701,6.7,6.4843,6.613,89452987.0319],[1526140800000,6.6133,6.6797,6.5801,6.6599,39757905.054],[1526227200000,6.6601,6.7,6.6244,6.6258,60700344.9326],[1526313600000,6.6258,6.6276,6.5302,6.5768,54257225.4678],[1526400000000,6.5768,6.6697,6.5677,6.5746,64851440.1254],[1526486400000,6.5741,6.5858,6.472,6.481,72652574.5024],[1526572800000,6.4818,6.624,6.4787,6.5905,62356280.3379],[1526659200000,6.5909,6.605,6.5406,6.578,21272510.1527],[1526745600000,6.5769,6.6,6.5476,6.572,22840203.0058],[1526832000000,6.5719,6.5726,6.5203,6.5321,22445419.095],[1526918400000,6.5322,6.5752,6.5268,6.566,17432558.4234],[1527004800000,6.566,6.6809,6.5579,6.6473,36996887.2614],[1527091200000,6.6467,6.75,6.6202,6.6388,37594215.7936],[1527177600000,6.6389,6.6416,6.5751,6.5769,28108423.8298],[1527264000000,6.577,6.6216,6.5658,6.568,20996618.3525],[1527350400000,6.5683,6.63,6.566,6.6,26708121.0461],[1527436800000,6.6,6.6366,6.595,6.6094,37613616.8488],[1527523200000,6.6098,6.6852,6.5903,6.596,38046664.993],[1527609600000,6.5956,6.5995,6.5563,6.5855,19438023.0031],[1527696000000,6.5855,6.6078,6.5301,6.5431,27798216.2179],[1527782400000,6.5439,6.576,6.524,6.5466,32802985.9876],[1527868800000,6.5466,6.5575,6.4782,6.5009,31377022.568],[1527955200000,6.501,6.5464,6.4663,6.4993,31897776.6651],[1528041600000,6.4992,6.53,6.4869,6.5265,26071529.796],[1528128000000,6.5267,6.5446,6.5051,6.5101,28568977.4764],[1528214400000,6.51,6.515,6.457,6.4586,22748131.76],[1528300800000,6.4579,6.4929,6.45,6.4685,22829095.4604],[1528387200000,6.4685,6.4979,6.4603,6.4784,20990428.5834],[1528473600000,6.478,6.4813,6.432,6.4499,28985173.7621],[1528560000000,6.45,6.5895,6.4468,6.5553,38212674.3542],[1528646400000,6.5559,6.6731,6.5401,6.56,67275926.8556],[1528732800000,6.5601,6.61,6.5301,6.591,26886542.2195],[1528819200000,6.5909,6.69,6.59,6.6329,37575609.9713],[1528905600000,6.6329,6.675,6.5876,6.625,31650305.7503],[1528992000000,6.6242,6.6249,6.555,6.5957,26573606.5913],[1529078400000,6.5957,6.6449,6.59,6.6353,21873245.9503],[1529164800000,6.634,6.6399,6.5958,6.6069,18468988.4928],[1529251200000,6.6068,6.6499,6.6051,6.6178,24267528.3614],[1529337600000,6.6178,6.6188,6.5707,6.5801,34794540.4754],[1529424000000,6.5802,6.61,6.5753,6.5753,31600620.366],[1529510400000,6.5753,6.5901,6.5691,6.5778,26438113.0764],[1529596800000,6.5779,6.68,6.5776,6.6732,46860369.6219],[1529683200000,6.6726,6.8494,6.6501,6.7063,36442850.1995],[1529769600000,6.7064,6.7699,6.671,6.7274,31023689.1792],[1529856000000,6.7275,6.8949,6.6716,6.6816,39298426.0513],[1529942400000,6.6838,6.7199,6.67,6.7168,28611624.0521],[1530028800000,6.7168,6.769,6.701,6.7349,31470712.5581],[1530115200000,6.735,6.7587,6.705,6.723,26327157.1837],[1530201600000,6.7232,6.78,6.7015,6.7546,34401486.1176],[1530288000000,6.7547,6.7559,6.6753,6.695,46079643.7305],[1530374400000,6.6974,6.715,6.6501,6.6607,30257410.0304],[1530460800000,6.6615,6.6959,6.6307,6.6374,32386546.9989],[1530547200000,6.6374,6.7346,6.622,6.7169,35463357.954],[1530633600000,6.7167,6.735,6.686,6.7099,30248855.2834],[1530720000000,6.7097,6.735,6.7001,6.7069,21015509.5681],[1530806400000,6.7068,6.735,6.7036,6.7159,30128296.6976],[1530892800000,6.7161,6.7197,6.6821,6.6958,17603960.9705],[1530979200000,6.6959,6.71,6.6265,6.6304,27903188.948],[1531065600000,6.6302,6.6699,6.6201,6.6297,15390991.7401],[1531152000000,6.63,6.6795,6.6291,6.6708,38004317.1155],[1531238400000,6.6696,6.709,6.646,6.6875,24727773.9652],[1531324800000,6.6871,6.7298,6.682,6.6924,18169063.3428],[1531411200000,6.6925,6.7147,6.671,6.7048,23765569.5385],[1531497600000,6.7049,6.7349,6.698,6.7274,14326285.8278],[1531584000000,6.7275,6.7349,6.701,6.7117,12847252.549],[1531670400000,6.7118,6.713,6.631,6.6417,23506022.978],[1531756800000,6.6415,6.6649,6.6123,6.6233,23887759.3066],[1531843200000,6.6248,6.6346,6.3457,6.5968,45943924.6954],[1531929600000,6.5967,6.665,6.5823,6.6597,26466124.4529],[1532016000000,6.6592,6.7239,6.6449,6.6754,35640400.0023],[1532102400000,6.6753,6.735,6.65,6.6945,29606906.5854],[1532188800000,6.6922,6.7248,6.6713,6.6739,11595302.6029],[1532275200000,6.674,6.71,6.6661,6.6954,26401057.7292],[1532361600000,6.6959,6.7795,6.6914,6.7264,38917525.8727],[1532448000000,6.7263,6.7635,6.7256,6.7456,26873539.2115],[1532534400000,6.7455,6.7527,6.7002,6.7317,22347809.732],[1532620800000,6.7317,6.8119,6.726,6.7484,39698996.4895],[1532707200000,6.7483,6.7633,6.741,6.7482,42517818.6817],[1532793600000,6.7485,6.7756,6.7465,6.7522,37468660.1668],[1532880000000,6.7523,6.769,6.742,6.7688,44665888.4426],[1532966400000,6.7688,6.8498,6.7551,6.8377,118413960.3716],[1533052800000,6.8375,6.906,6.8003,6.8379,75744616.7697],[1533139200000,6.8364,6.971,6.835,6.8873,71116976.4629],[1533225600000,6.8873,6.986,6.8725,6.8982,47382848.2414],[1533312000000,6.8982,6.9382,6.8811,6.9298,47572662.7271],[1533398400000,6.9299,6.96,6.9183,6.9346,40552022.0359],[1533484800000,6.9346,6.9388,6.894,6.9098,54882239.2066],[1533571200000,6.9098,6.9549,6.8867,6.8902,63484979.0372],[1533657600000,6.8902,7.2,6.8832,6.9726,145145621.9379],[1533744000000,6.9727,7.0588,6.9558,6.9571,86404893.3441],[1533830400000,6.9571,7.0166,6.9501,6.9881,44701491.4855],[1533916800000,6.9882,7.1699,6.9791,7.0831,87036887.5936],[1534003200000,7.0834,7.0987,7.025,7.0519,50354138.3276],[1534089600000,7.0517,7.0935,7.0258,7.0692,56350519.4606],[1534176000000,7.0655,7.11,7.0401,7.064,93827782.3227],[1534262400000,7.0643,7.0721,7.0013,7.009,96692930.5067],[1534348800000,7.0091,7.057,6.98,6.9879,80060897.0465],[1534435200000,6.9881,7.0189,6.9363,6.9555,62563814.3188],[1534521600000,6.957,7.029,6.905,7.0121,88937555.0727],[1534608000000,7.012,7.0322,6.9711,6.9916,79753750.687],[1534694400000,6.9919,7.008,6.9557,6.9727,46280816.2981],[1534780800000,6.9707,7.018,6.95,6.9506,67170308.0813],[1534867200000,6.9505,6.956,6.86,6.9096,73036975.1444],[1534953600000,6.9095,6.96,6.9072,6.9319,54152229.6446],[1535040000000,6.932,6.9344,6.8801,6.8845,40636062.5395],[1535126400000,6.884,6.8876,6.7999,6.8142,38013809.1569],[1535212800000,6.8143,6.8535,6.8056,6.8325,27044514.8141],[1535299200000,6.831,6.8449,6.77,6.7959,51895830.0432],[1535385600000,6.7967,6.8079,6.7195,6.7521,74467552.7172],[1535472000000,6.7523,6.7889,6.6116,6.7421,126323895.3371],[1535558400000,6.7421,6.8649,6.7358,6.8601,109011939.2799],[1535644800000,6.8601,6.885,6.8201,6.8651,90156962.7799],[1535731200000,6.8655,6.87,6.8131,6.8159,107192781.7139],[1535817600000,6.8154,6.87,6.8109,6.8459,132845982.4455],[1535904000000,6.846,6.8629,6.8164,6.8297,92867749.3829],[1535990400000,6.8307,6.8727,6.821,6.851,81029336.331],[1536076800000,6.8511,6.9848,6.842,6.9687,118315595.6334],[1536163200000,6.9692,7.1205,6.9527,6.9947,194608988.2124],[1536249600000,6.9949,7.0339,6.9701,6.9934,134085028.916],[1536336000000,6.9931,7.018,6.98,7.0008,82513832.4138],[1536422400000,7.0008,7.0598,6.961,6.9744,146984585.8178],[1536508800000,6.9746,7.0132,6.958,6.9777,140791065.7747],[1536595200000,6.9777,7.007,6.961,6.974,148797746.3493],[1536681600000,6.974,7,6.9623,6.9789,143577768.0321],[1536768000000,6.9787,6.9824,6.9032,6.9036,133210365.4811],[1536854400000,6.9035,6.9646,6.8845,6.9264,152887470.9494],[1536940800000,6.9263,6.935,6.9001,6.926,118400250.0674],[1537027200000,6.926,6.9496,6.9035,6.9237,113774998.9167],[1537113600000,6.9237,6.99,6.9022,6.9701,115303229.0018],[1537200000000,6.9701,7.0433,6.9322,6.9407,147141205.9481],[1537286400000,6.9413,6.955,6.9166,6.9221,94692418.3653],[1537372800000,6.9221,6.9746,6.8923,6.9008,108745601.7045],[1537459200000,6.901,6.916,6.821,6.836,196556308.2982],[1537545600000,6.836,6.866,6.7621,6.8524,159090308.4945],[1537632000000,6.8527,6.8586,6.804,6.8348,106652749.8121],[1537718400000,6.8349,6.8585,6.8111,6.854,129471197.7724],[1537804800000,6.8539,6.952,6.8332,6.9435,148688432.4455],[1537891200000,6.9435,6.9628,6.8918,6.899,139342430.5499],[1537977600000,6.8991,6.9288,6.8835,6.8876,129534164.2943],[1538064000000,6.8877,6.8955,6.8144,6.8416,157612868.142],[1538150400000,6.8415,6.9155,6.83,6.864,150240031.9596],[1538236800000,6.864,6.879,6.8307,6.8568,106663168.824],[1538323200000,6.8569,6.9399,6.8516,6.9092,159320644.5588],[1538409600000,6.9088,6.925,6.8759,6.9142,100353328.1611],[1538496000000,6.9142,6.9449,6.89,6.9242,126444838.6474],[1538582400000,6.9241,6.9378,6.89,6.8968,94822235.9249],[1538668800000,6.8968,6.9151,6.8766,6.8934,87743020.4614],[1538755200000,6.8935,6.9066,6.8741,6.9021,83651278.4215],[1538841600000,6.9022,6.924,6.895,6.9094,64155324.3706],[1538928000000,6.9095,6.9149,6.8821,6.885,62023310.0942],[1539014400000,6.885,6.8907,6.8585,6.8749,69103928.5061],[1539100800000,6.8749,6.8966,6.867,6.8911,58188172.0035],[1539187200000,6.8909,6.9835,6.8742,6.9572,149523091.9126],[1539273600000,6.9572,6.9957,6.943,6.9604,64026674.3512]],"moneyType":"cny","USDCNY":"**"}}'''
data = json.loads(data)

data = jsonpath.jsonpath(data,'$..data')
data = data[0]
client = MongoClient('0.0.0.0', 0)
collection = client["BOOMHASH"]["USDT_CNY_OLDS"]
for i in data:
    # print(i)
    times = int(i[0] / 1000)
    value = i[4]
    times = time.strftime("%Y--%m--%d 08:00:00", time.localtime(int(times)))

    timeArray = time.strptime(times, "%Y--%m--%d %H:%M:%S")
    times = int(time.mktime(timeArray))


    SunMongodb.insert_mongo(collection, dict(time = times,value= value))